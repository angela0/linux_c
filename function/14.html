<html>

<head>
  <title>Untitled Document</title>
  <meta charset="utf-8">
  <script type="text/javascript" src="../scripts/shCore.js"></script>
  <script type="text/javascript" src="../scripts/shBrushCpp.js"></script>
  <link type="text/css" rel="stylesheet" href="../styles/shCoreDefault.css" />
  <link type="text/css" rel="stylesheet" href="../styles/all.css" />
  <script type="text/javascript">
    SyntaxHighlighter.all();
  </script>
</head>

<body>
  <table class="table">
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=accept></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      accept(接受socket连线) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#socket">socket</a>,
        <a href="12.html#bind">bind</a>,
        <a href="12.html#listen">listen</a>,
        <a href="12.html#connect">connect</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        #include "sys/types.h" <br/>
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int accept(int s,struct sockaddr 
      * addr,int * addrlen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> accept()用来接受参数s的socket连线。参数s的socket必需先经bind()、listen()函数处理过，当有连线进来时accept()会返回一个新的socket处理代码，往后的数据传送与读取就是经由新的socket处理，而原来参数s的socket能继续使用accept()来接受新的连线要求。连线成功时，参数addr所指的结构会被系统填入远程主机的地址数据，参数addrlen为scokaddr的结构长度。关于结构sockaddr的定义请参考bind()。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回新的socket处理代码，失败返回-1，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s 非合法socket处理代码。
      EFAULT 参数addr指针指向无法存取的内存空间。
      ENOTSOCK 参数s为一文件描述词，非socket。
      EOPNOTSUPP 指定的socket并非SOCK_STREAM。
      EPERM 防火墙拒绝此连线。
      ENOBUFS 系统的缓冲内存不足。
      ENOMEM 核心内存不足。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考listen()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=bind></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      bind(对socket定位) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#socket">socket</a>,
        <a href="12.html#accept">accept</a>,
        <a href="12.html#connect">connect</a>,
        <a href="12.html#listen">listen</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        #include "sys/types.h" <br/>
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int bind(int sockfd,struct sockaddr 
      * my_addr,int addrlen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> bind()用来设置给参数sockfd的socket一个名称。此名称由参数my_addr指向一sockaddr结构，对于不同的socket 
      domain定义了一个通用的数据结构
      struct sockaddr
      {
      unsigned short int sa_family;
      char sa_data[14];
      };
      sa_family 为调用socket()时的domain参数，即AF_xxxx值。
      sa_data 最多使用14个字符长度。
      此sockaddr结构会因使用不同的socket domain而有不同结构定义，例如使用AF_INET domain，其socketaddr结构定义便为
      struct socketaddr_in
      {
      unsigned short int sin_family;
      uint16_t sin_port;
      struct in_addr sin_addr;
      unsigned char sin_zero[8];
      };
      struct in_addr
      {
      uint32_t s_addr;
      };
      sin_family 即为sa_family
      sin_port 为使用的port编号
      sin_addr.s_addr 为IP 地址
      sin_zero 未使用。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 参数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> addrlen为sockaddr的结构长度。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，失败返回-1，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数sockfd 非合法socket处理代码。
      EACCESS 权限不足
      ENOTSOCK 参数sockfd为一文件描述词，非socket。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考listen()
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=connect></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      connect(建立socket连线) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#socket">socket</a>,
        <a href="12.html#bind">bind</a>,
        <a href="12.html#listen">listen</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        #include "sys/types.h" <br/>
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int connect (int sockfd,struct 
      sockaddr * serv_addr,int addrlen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> connect()用来将参数sockfd 的socket 连至参数serv_addr 
      指定的网络地址。结构sockaddr请参考bind()。参数addrlen为sockaddr的结构长度。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，失败返回-1，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数sockfd 非合法socket处理代码
      EFAULT 参数serv_addr指针指向无法存取的内存空间
      ENOTSOCK 参数sockfd为一文件描述词，非socket。
      EISCONN 参数sockfd的socket已是连线状态
      ECONNREFUSED 连线要求被server端拒绝。
      ETIMEDOUT 企图连线的操作超过限定时间仍未有响应。
      ENETUNREACH 无法传送数据包至指定的主机。
      EAFNOSUPPORT sockaddr结构的sa_family不正确。
      EALREADY socket为不可阻断且先前的连线操作还未完成。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> /* 利用socket的TCP client
      此程序会连线TCP server，并将键盘输入的字符串传送给server。
      TCP server范例请参考listen()。
      */
      #include "sys/stat.h"
      #include "fcntl.h"
      #include "unistd.h"
      #include "sys/types.h"
      #include "sys/socket.h"
      #include "netinet/in.h"
      #include "arpa/inet.h"
      #define PORT 1234
      #define SERVER_IP “127.0.0.1”
      main()
      {
      int s;
      struct sockaddr_in addr;
      char buffer[256];
      if((s = socket(AF_INET,SOCK_STREAM,0)) "0){
      perror(“socket”);
      exit(1);
      }
      /* 填写sockaddr_in结构*/
      bzero(&addr,sizeof(addr));
      addr.sin_family = AF_INET;
      addr.sin_port=htons(PORT);
      addr.sin_addr.s_addr = inet_addr(SERVER_IP);
      /* 尝试连线*/
      if(connect(s,&addr,sizeof(addr)) "0){
      perror(“connect”);
      exit(1);
      }
      /* 接收由server端传来的信息*/
      recv(s,buffer,sizeof(buffer),0);
      printf(“%s\n”,buffer);
      while(1){
      bzero(buffer,sizeof(buffer));
      /* 从标准输入设备取得字符串*/
      read(STDIN_FILENO,buffer,sizeof(buffer));
      /* 将字符串传给server端*/
      if(send(s,buffer,sizeof(buffer),0) "0){
      perror(“send”);
      exit(1);
      }
      }
      }
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行 </font> </div>
      </td>
      <td valign="top"> <font class="font"> $ ./connect
      Welcome to server!
      hi I am client! /*键盘输入*/
      /* "Ctrl+C"中断程序*/
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=endprotoent></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      endprotoent(结束网络协议数据的读取) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#getprotoent">getprotoent</a>,
        <a href="12.html#getprotobyname">getprotobyname</a>,
        <a href="12.html#getprotobynumber">getprotobynumber</a>,
        <a href="12.html#setprotoent">setprotoent</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "netdb.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> void endprotoent(void);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> endprotoent()用来关闭由getprotoent()打开的文件。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考getprotoent()
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=endservent></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      endservent(结束网络服务数据的读取) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#getservent">getservent</a>,
        <a href="12.html#getservbyname">getservbyname</a>,
        <a href="12.html#getservbyport">getservbyport</a>,
        <a href="12.html#setservent">setservent</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "netdb.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> void endservent(void);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> endservent()用来关闭由getservent()所打开的文件。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考getservent()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=getsockopt></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      getsockopt(取得socket状态) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#setsockopt">setsockopt</a>
        
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int getsockopt(int s,int level,int 
      optname,void* optval,socklen_t* optlen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> getsockopt()会将参数s所指定的socket状态返回。参数optname代表欲取得何种选项状态，而参数optval则指向欲保存结果的内存地址，参数optlen则为该空间的大小。参数level、optname请参考setsockopt()。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，若有错误则返回-1，错误原因存于errno
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s 并非合法的socket处理代码
      ENOTSOCK 参数s为一文件描述词，非socket
      ENOPROTOOPT 参数optname指定的选项不正确
      EFAULT 参数optval指针指向无法存取的内存空间
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      main()
      {
      int s,optval,optlen = sizeof(int);
      if((s = socket(AF_INET,SOCK_STREAM,0)) "0) perror(“socket”);
      getsockopt(s,SOL_SOCKET,SO_TYPE,&optval,&optlen);
      printf(“optval = %d\n”,optval);
      close(s);}
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行 </font> </div>
      </td>
      <td valign="top"> <font class="font"> optval = 1 /*SOCK_STREAM的定义正是此值*/
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=htonl></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      htonl(将32位主机字符顺序转换成网络字符顺序) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#htons">htons</a>,
        <a href="12.html#ntohl">ntohl</a>,
        <a href="12.html#ntohs">ntohs</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "netinet/in.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> unsigned long int htonl(unsigned 
      long int hostlong);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> htonl()用来将参数指定的32位hostlong 转换成网络字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回对应的网络字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考getservbyport()或connect()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=htons></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      htons(将16位主机字符顺序转换成网络字符顺序) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#htonl">htonl</a>,
        <a href="12.html#ntohl">ntohl</a>,
        <a href="12.html#ntohs">ntohs</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "netinet/in.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> unsigned short int htons(unsigned 
      short int hostshort);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> htons()用来将参数指定的16位hostshort转换成网络字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回对应的网络字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考connect()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=inet_addr></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      inet_addr(将网络地址转成二进制的数字) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#inet_aton">inet_aton</a>,
        <a href="12.html#inet_ntoa">inet_ntoa</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/socket.h" <br/>
      #include "netinet/in.h" <br/>
      #include "arpa/inet.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> unsigned long int inet_addr(const 
      char *cp);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> inet_addr()用来将参数cp所指的网络地址字符串转换成网络所使用的二进制数字。网络地址字符串是以数字和点组成的字符串，例如:“163.13.132.68”。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回对应的网络二进制的数字，失败返回-1。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=inet_aton></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      inet_aton(将网络地址转成网络二进制的数字) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#inet_addr">inet_addr</a>,
        <a href="12.html#inet_ntoa">inet_ntoa</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/scoket.h" <br/>
      #include "netinet/in.h" <br/>
      #include "arpa/inet.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int inet_aton(const char * cp,struct 
      in_addr *inp);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> inet_aton()用来将参数cp所指的网络地址字符串转换成网络使用的二进制的数字，然后存于参数inp所指的in_addr结构中。
      结构in_addr定义如下
      struct in_addr
      {
      unsigned long int s_addr;
      };
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回非0值，失败则返回0。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=inet_ntoa></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      inet_ntoa(将网络二进制的数字转换成网络地址) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#inet_addr">inet_addr</a>,
        <a href="12.html#inet_aton">inet_aton</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/socket.h" <br/>
      #include "netinet/in.h" <br/>
      #include "arpa/inet.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> char * inet_ntoa(struct in_addr 
      in);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> inet_ntoa()用来将参数in所指的网络二进制的数字转换成网络地址，然后将指向此网络地址字符串的指针返回。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回字符串指针，失败则返回NULL。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=listen></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      listen(监听) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#socket">socket</a>,
        <a href="12.html#bind">bind</a>,
        <a href="12.html#accept">accept</a>,
        <a href="12.html#connect">connect</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int listen(int s,int backlog);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> listen()用来等待参数s 的socket连线。参数backlog指定同时能处理的最大连接要求，如果连接数目达此上限则client端将收到ECONNREFUSED的错误。Listen()并未开始接收连线，只是设置socket为listen模式，真正接收client端连线的是accept()。通常listen()会在socket()，bind()之后调用，接着才调用accept()。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，失败返回-1，错误原因存于errno
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 附加说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> listen()只适用SOCK_STREAM或SOCK_SEQPACKET的socket类型。如果socket为AF_INET则参数backlog 
      最大值可设至128。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数sockfd非合法socket处理代码
      EACCESS 权限不足
      EOPNOTSUPP 指定的socket并未支援listen模式。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      #include "netinet/in.h"
      #include "arpa/inet.h"
      #include "unistd.h"
      #define PORT 1234
      #define MAXSOCKFD 10
      main()
      {
      int sockfd,newsockfd,is_connected[MAXSOCKFD],fd;
      struct sockaddr_in addr;
      int addr_len = sizeof(struct sockaddr_in);
      fd_set readfds;
      char buffer[256];
      char msg[ ] =”Welcome to server!”;
      if ((sockfd = socket(AF_INET,SOCK_STREAM,0)) "0){
      perror(“socket”);
      exit(1);
      }
      bzero(&addr,sizeof(addr));
      addr.sin_family =AF_INET;
      addr.sin_port = htons(PORT);
      addr.sin_addr.s_addr = htonl(INADDR_ANY);
      if(bind(sockfd,&addr,sizeof(addr)) "0){
      perror(“connect”);
      exit(1);
      }
      if(listen(sockfd,3) "0){
      perror(“listen”);
      exit(1);
      }
      for(fd=0;fd "MAXSOCKFD;fd++)
      is_connected[fd]=0;
      while(1){
      FD_ZERO(&readfds);
      FD_SET(sockfd,&readfds);
      for(fd=0;fd "MAXSOCKFD;fd++)
      if(is_connected[fd]) FD_SET(fd,&readfds);
      if(!select(MAXSOCKFD,&readfds,NULL,NULL,NULL))continue;
      for(fd=0;fd "MAXSOCKFD;fd++)
      if(FD_ISSET(fd,&readfds)){
      if(sockfd = =fd){
      if((newsockfd = accept (sockfd,&addr,&addr_len)) "0)
      perror(“accept”);
      write(newsockfd,msg,sizeof(msg));
      is_connected[newsockfd] =1;
      printf(“cnnect from %s\n”,inet_ntoa(addr.sin_addr));
      }else{
      bzero(buffer,sizeof(buffer));
      if(read(fd,buffer,sizeof(buffer)) "=0){
      printf(“connect closed.\n”);
      is_connected[fd]=0;
      close(fd);
      }else
      printf(“%s”,buffer);
      }
      }
      }
      }
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行 </font> </div>
      </td>
      <td valign="top"> <font class="font"> $ ./listen
      connect from 127.0.0.1
      hi I am client
      connected closed.
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=ntohl></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      ntohl(将32位网络字符顺序转换成主机字符顺序) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#htonl">htonl</a>,
        <a href="12.html#htons">htons</a>,
        <a href="12.html#ntohs">ntohs</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "netinet/in.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> unsigned long int ntohl(unsigned 
      long int netlong);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> ntohl()用来将参数指定的32位netlong转换成主机字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回对应的主机字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考getservent()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=ntohs></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      ntohs(将16位网络字符顺序转换成主机字符顺序) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#htonl">htonl</a>,
        <a href="12.html#htons">htons</a>,
        <a href="12.html#ntohl">ntohl</a>   <!--this is a tag-->
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "netinet/in.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> unsigned short int ntohs(unsigned 
      short int netshort);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> ntohs()用来将参数指定的16位netshort转换成主机字符顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回对应的主机顺序。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考getservent()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=recv></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      recv(经socket接收数据) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        recvfrom，recvmsg，send，sendto，socket
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int recv(int s,void *buf,int len,unsigned 
      int flags);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> recv()用来接收远端主机经指定的socket传来的数据，并把数据存到由参数buf 
      指向的内存空间，参数len为可接收数据的最大长度。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 参数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> flags一般设0。其他数值定义如下:
      MSG_OOB 接收以out-of-band 送出的数据。
      MSG_PEEK 返回来的数据并不会在系统内删除，如果再调用recv()会返回相同的数据内容。
      MSG_WAITALL强迫接收到len大小的数据后才能返回，除非有错误或信号产生。
      MSG_NOSIGNAL此操作不愿被SIGPIPE信号中断返回值成功则返回接收到的字符数，失败返回-1，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s非合法的socket处理代码
      EFAULT 参数中有一指针指向无法存取的内存空间
      ENOTSOCK 参数s为一文件描述词，非socket。
      EINTR 被信号所中断
      EAGAIN 此动作会令进程阻断，但参数s的socket为不可阻断
      ENOBUFS 系统的缓冲内存不足。
      ENOMEM 核心内存不足
      EINVAL 传给系统调用的参数不正确。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考listen()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=recvfrom></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      recvfrom(经socket接收数据) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        recv，recvmsg，send，sendto，socket
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int recvfrom(int s,void *buf,int 
      len,unsigned int flags ,struct sockaddr *from ,int *fromlen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> recv()用来接收远程主机经指定的socket 传来的数据，并把数据存到由参数buf 
      指向的内存空间，参数len 为可接收数据的最大长度。参数flags 一般设0，其他数值定义请参考recv()。参数from用来指定欲传送的网络地址，结构sockaddr 
      请参考bind()。参数fromlen为sockaddr的结构长度。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回接收到的字符数，失败则返回-1，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s非合法的socket处理代码
      EFAULT 参数中有一指针指向无法存取的内存空间。
      ENOTSOCK 参数s为一文件描述词，非socket。
      EINTR 被信号所中断。
      EAGAIN 此动作会令进程阻断，但参数s的socket为不可阻断。
      ENOBUFS 系统的缓冲内存不足
      ENOMEM 核心内存不足
      EINVAL 传给系统调用的参数不正确。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> /*利用socket的UDP client
      此程序会连线UDP server，并将键盘输入的字符串传给server。
      UDP server 范例请参考sendto()。
      */
      #include "sys/stat.h"
      #include "fcntl.h"
      #include "unistd.h"
      #include "sys/typs.h"
      #include "sys/socket.h"
      #include "netinet/in.h"
      #include "arpa/inet.h"
      #define PORT 2345
      #define SERVER_IP “127.0.0.1”
      main()
      {
      int s,len;
      struct sockaddr_in addr;
      int addr_len =sizeof(struct sockaddr_in);
      char buffer[256];
      /* 建立socket*/
      if((s = socket(AF_INET,SOCK_DGRAM,0)) "0){
      perror(“socket”);
      exit(1);
      }
      /* 填写sockaddr_in*/
      bzero(&addr,sizeof(addr));
      addr.sin_family = AF_INET;
      addr.sin_port = htons(PORT);
      addr.sin_addr.s_addr = inet_addr(SERVER_IP);
      while(1){
      bzero(buffer,sizeof(buffer));
      /* 从标准输入设备取得字符串*/
      len =read(STDIN_FILENO,buffer,sizeof(buffer));
      /* 将字符串传送给server端*/
      sendto(s,buffer,len,0,&addr,addr_len);
      /* 接收server端返回的字符串*/
      len = recvfrom(s,buffer,sizeof(buffer),0,&addr,&addr_len);
      printf(“receive: %s”,buffer);
      }
      }
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行 </font> </div>
      </td>
      <td valign="top"> <font class="font"> (先执行udp server 再执行udp client)
      hello /*从键盘输入字符串*/
      receive: hello /*server端返回来的字符串*/
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=recvmsg></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      recvmsg(经socket接收数据) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        recv，recvfrom，send，sendto，sendmsg，socket
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socktet.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int recvmsg(int s,struct msghdr 
      *msg,unsigned int flags);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> recvmsg()用来接收远程主机经指定的socket传来的数据。参数s为已建立好连线的socket，如果利用UDP协议则不需经过连线操作。参数msg指向欲连线的数据结构内容，参数flags一般设0，详细描述请参考send()。关于结构msghdr的定义请参考sendmsg()。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回接收到的字符数，失败则返回-1，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s非合法的socket处理代码。
      EFAULT 参数中有一指针指向无法存取的内存空间
      ENOTSOCK 参数s为一文件描述词，非socket。
      EINTR 被信号所中断。
      EAGAIN 此操作会令进程阻断，但参数s的socket为不可阻断。
      ENOBUFS 系统的缓冲内存不足
      ENOMEM 核心内存不足
      EINVAL 传给系统调用的参数不正确。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考recvfrom()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=send></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      send(经socket传送数据) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        sendto，sendmsg，recv，recvfrom，socket
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int send(int s,const void * msg,int 
      len,unsigned int falgs);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> send()用来将数据由指定的socket 传给对方主机。参数s为已建立好连接的socket。参数msg指向欲连线的数据内容，参数len则为数据长度。参数flags一般设0，其他数值定义如下
      MSG_OOB 传送的数据以out-of-band 送出。
      MSG_DONTROUTE 取消路由表查询
      MSG_DONTWAIT 设置为不可阻断运作
      MSG_NOSIGNAL 此动作不愿被SIGPIPE 信号中断。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回实际传送出去的字符数，失败返回-1。错误原因存于errno
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s 非合法的socket处理代码。
      EFAULT 参数中有一指针指向无法存取的内存空间
      ENOTSOCK 参数s为一文件描述词，非socket。
      EINTR 被信号所中断。
      EAGAIN 此操作会令进程阻断，但参数s的socket为不可阻断。
      ENOBUFS 系统的缓冲内存不足
      ENOMEM 核心内存不足
      EINVAL 传给系统调用的参数不正确。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考connect()
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=sendmsg></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      sendmsg(经socket传送数据) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        send，sendto，recv，recvfrom，recvmsg，socket
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int sendmsg(int s,const strcut 
      msghdr *msg,unsigned int flags);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> sendmsg()用来将数据由指定的socket传给对方主机。参数s为已建立好连线的socket，如果利用UDP协议则不需经过连线操作。参数msg 
      指向欲连线的数据结构内容，参数flags一般默认为0，详细描述请参考send()。
      结构msghdr定义如下
      struct msghdr
      {
      void *msg_name; /*Address to send to /receive from . */
      socklen_t msg_namelen; /* Length of addres data */
      strcut iovec * msg_iov; /* Vector of data to send/receive into */
      size_t msg_iovlen; /* Number of elements in the vector */
      void * msg_control; /* Ancillary dat */
      size_t msg_controllen; /* Ancillary data buffer length */
      int msg_flags; /* Flags on received message */
      };
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回实际传送出去的字符数，失败返回-1，错误原因存于errno
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s 非合法的socket处理代码。
      EFAULT 参数中有一指针指向无法存取的内存空间
      ENOTSOCK 参数s为一文件描述词，非socket。
      EINTR 被信号所中断。
      EAGAIN 此操作会令进程阻断，但参数s的socket为不可阻断。
      ENOBUFS 系统的缓冲内存不足
      ENOMEM 核心内存不足
      EINVAL 传给系统调用的参数不正确。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考sendto()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=sendto></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      sendto(经socket传送数据) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        send , sendmsg,recv , recvfrom 
      , socket
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include  " sys/types.h "
      #include  " sys/socket.h "
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int sendto ( int s , const void 
      * msg, int len, unsigned int flags, const 
      struct sockaddr * to , int tolen ) ;
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> sendto() 用来将数据由指定的socket传给对方主机。参数s为已建好连线的socket,如果利用UDP协议则不需经过连线操作。参数msg指向欲连线的数据内容，参数flags 
      一般设0，详细描述请参考send()。参数to用来指定欲传送的网络地址，结构sockaddr请参考bind()。参数tolen为sockaddr的结果长度。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回实际传送出去的字符数，失败返回－1，错误原因存于errno 
      中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s非法的socket处理代码。
      EFAULT 参数中有一指针指向无法存取的内存空间。
      WNOTSOCK canshu s为一文件描述词，非socket。
      EINTR 被信号所中断。
      EAGAIN 此动作会令进程阻断，但参数s的soket为补课阻断的。
      ENOBUFS 系统的缓冲内存不足。
      EINVAL 传给系统调用的参数不正确。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include  " sys/types.h "
      #include  " sys/socket.h "
      # include  "netinet.in.h"
      #include  "arpa.inet.h"
      #define PORT 2345 /*使用的port*/
      main(){
      int sockfd,len;
      struct sockaddr_in addr;
      char buffer[256];
      /*建立socket*/
      if(sockfd=socket (AF_INET,SOCK_DGRAM,0)) "0){
      perror (“socket”);
      exit(1);
      }
      /*填写sockaddr_in 结构*/
      bzero ( &addr, sizeof(addr) );
      addr.sin_family=AF_INET;
      addr.sin_port=htons(PORT);
      addr.sin_addr=hton1(INADDR_ANY) ;
      if (bind(sockfd, &addr, sizeof(addr)) "0){
      perror(“connect”);
      exit(1);
      }
      while(1){
      bezro(buffer,sizeof(buffer));
      len = recvfrom(socket,buffer,sizeof(buffer), 0 , &addr &addr_len);
      /*显示client端的网络地址*/
      printf(“receive from %s\n “ , inet_ntoa( addr.sin_addr));
      /*将字串返回给client端*/
      sendto(sockfd,buffer,len,0,&addr,addr_len);”
      }
      }
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 请参考recvfrom()
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=setprotoent></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      setprotoent(打开网络协议的数据文件) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        getprotobyname, getprotobynumber, 
      endprotoent
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include  "netdb.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> void setprotoent (int stayopen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> setprotoent()用来打开/etc/protocols， 
      如果参数stayopen值为1，则接下来的getprotobyname()或getprotobynumber()将不会自动关闭此文件。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=setservent></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      setservent(打开主机网络服务的数据文件) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        getservent, getservbyname, getservbyport, 
      endservent
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include  " netdb.h "
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> void setservent (int stayopen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> setservent()用来打开/etc/services，如果参数stayopen值为1，则接下来的getservbyname()或getservbyport()将补回自动关闭文件。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=setsockopt></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      setsockopt(设置socket状态) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>
        getsockopt
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int setsockopt(int s,int level,int 
      optname,const void * optval,,socklen_toptlen);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> setsockopt()用来设置参数s所指定的socket状态。参数level代表欲设置的网络层，一般设成SOL_SOCKET以存取socket层。参数optname代表欲设置的选项，有下列几种数值:
      SO_DEBUG 打开或关闭排错模式
      SO_REUSEADDR 允许在bind()过程中本地地址可重复使用
      SO_TYPE 返回socket形态。
      SO_ERROR 返回socket已发生的错误原因
      SO_DONTROUTE 送出的数据包不要利用路由设备来传输。
      SO_BROADCAST 使用广播方式传送
      SO_SNDBUF 设置送出的暂存区大小
      SO_RCVBUF 设置接收的暂存区大小
      SO_KEEPALIVE 定期确定连线是否已终止。
      SO_OOBINLINE 当接收到OOB 数据时会马上送至标准输入设备
      SO_LINGER 确保数据安全且可靠的传送出去。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 参数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> optval代表欲设置的值，参数optlen则为optval的长度。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，若有错误则返回-1，错误原因存于errno。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 附加说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s并非合法的socket处理代码
      ENOTSOCK 参数s为一文件描述词，非socket
      ENOPROTOOPT 参数optname指定的选项不正确。
      EFAULT 参数optval指针指向无法存取的内存空间。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考getsockopt()。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=shutdown></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      shutdown(终止socket通信) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        socket，connect
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int shutdown(int s,int how);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> shutdown()用来终止参数s所指定的socket连线。参数s是连线中的socket处理代码，参数how有下列几种情况:
      how=0 终止读取操作。
      how=1 终止传送操作
      how=2 终止读取及传送操作
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，失败返回-1，错误原因存于errno。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EBADF 参数s不是有效的socket处理代码
      ENOTSOCK 参数s为一文件描述词，非socket
      ENOTCONN 参数s指定的socket并未连线
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=socket></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
      socket(建立一个socket通信) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>,
        <a href="12.html#"></a>
        accept，bind，connect，listen
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "sys/types.h"
      #include "sys/socket.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int socket(int domain,int type,int 
      protocol);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> socket()用来建立一个新的socket，也就是向系统注册，通知系统建立一通信端口。参数domain 
      指定使用何种的地址类型，完整的定义在/usr/include/bits/socket.h 内，底下是常见的协议:
      PF_UNIX/PF_LOCAL/AF_UNIX/AF_LOCAL UNIX 进程通信协议
      PF_INET?AF_INET Ipv4网络协议
      PF_INET6/AF_INET6 Ipv6 网络协议
      PF_IPX/AF_IPX IPX-Novell协议
      PF_NETLINK/AF_NETLINK 核心用户接口装置
      PF_X25/AF_X25 ITU-T X.25/ISO-8208 协议
      PF_AX25/AF_AX25 业余无线AX.25协议
      PF_ATMPVC/AF_ATMPVC 存取原始ATM PVCs
      PF_APPLETALK/AF_APPLETALK appletalk(DDP)协议
      PF_PACKET/AF_PACKET 初级封包接口
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 参数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> type有下列几种数值:
      SOCK_STREAM 提供双向连续且可信赖的数据流，即TCP。支持
      OOB 机制，在所有数据传送前必须使用connect()来建立连线状态。
      SOCK_DGRAM 使用不连续不可信赖的数据包连接
      SOCK_SEQPACKET 提供连续可信赖的数据包连接
      SOCK_RAW 提供原始网络协议存取
      SOCK_RDM 提供可信赖的数据包连接
      SOCK_PACKET 提供和网络驱动程序直接通信。
      protocol用来指定socket所使用的传输协议编号，通常此参考不用管它，设为0即可。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回socket处理代码，失败返回-1。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EPROTONOSUPPORT 参数domain指定的类型不支持参数type或protocol指定的协议
      ENFILE 核心内存不足，无法建立新的socket结构
      EMFILE 进程文件表溢出，无法再建立新的socket
      EACCESS 权限不足，无法建立type或protocol指定的协议
      ENOBUFS/ENOMEM 内存不足
      EINVAL 参数domain/type/protocol不合法
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 参考connect()。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div">
          
        </div>
      </td>
    </tr>
  </table>
</body>

</html>