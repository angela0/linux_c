<html>

<head>
  <title>Untitled Document</title>
  <meta charset="utf-8">
  <script type="text/javascript" src="../scripts/shCore.js"></script>
  <script type="text/javascript" src="../scripts/shBrushCpp.js"></script>
  <link type="text/css" rel="stylesheet" href="../styles/shCoreDefault.css" />
  <link type="text/css" rel="stylesheet" href="../styles/all.css" />
  <script type="text/javascript">
    SyntaxHighlighter.all();
  </script>
</head>

<body>
  <table class="table">
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=asctime></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> asctime(将时间和日期以字符串格式表示) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#ctime">ctime</a>,
        <a href="04.html#gmtime">gmtime</a>,
        <a href="04.html#localtime">localtime</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "time.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> char * asctime(const struct tm * timeptr);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> asctime()将参数timeptr所指的tm结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果以字符串形态返回。此函数已经由时区转换成当地时间，字符串格式为:"Wed Jun 30 21:49:08 1993\n"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 若再调用相关的时间日期函数，此字符串可能会被破坏。此函数与ctime不同处在于传入的参数是不同的结构。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 附加说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回一字符串表示目前当地的时间日期。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          #include "stdio.h"
          #include  "time.h"

          int main(int argc, char const *argv[])
          {
              time_t timep;
              time (&timep);
              printf("%s", asctime(gmtime(&timep)));
              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font">
        <pre class="brush: cpp;">
          Mon May 11 14:29:13 2015
        </pre>
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          
          <font class="font"><a name=ctime></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> ctime(将时间和日期以字符串格式表示) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#asctime">asctime</a>,
        <a href="04.html#gmtime">gmtime</a>,
        <a href="04.html#localtime">localtime</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "time.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> char *ctime(const time_t *timep);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> ctime()将参数timep所指的time_t结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果以字符串形态返回。此函数已经由时区转换成当地时间，字符串格式为"Wed Jun 30 21 :49 :08 1993\n"。若再调用相关的时间日期函数，此字符串可能会被破坏。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回一字符串表示目前当地的时间日期。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          #include "stdio.h"
          #include "time.h"

          int main(int argc, char const *argv[])
          {
              time_t timep;
              time (&timep);
              printf("%s", ctime(&timep));
              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font">
        <pre class="brush: cpp;">
          Mon May 11 22:31:57 2015
        </pre>
      </font> </td>
    </tr>
    <tr></tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=gettimeofday></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> gettimeofday(取得目前的时间) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#ctime">ctime</a>,
        <a href="04.html#ftime">ftime</a>,
        <a href="04.html#settimeofday">settimeofday</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        #include "sys/time.h"
        #include  "unistd.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int gettimeofday ( struct timeval * tv , struct timezone * tz )
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> gettimeofday()会把目前的时间有tv所指的结构返回，当地时区的信息则放到tz所指的结构中。
      timeval结构定义为:
        
      <pre class="brush: cpp;">
      struct timeval{
        long tv_sec; /*秒*/
        long tv_usec; /*微秒*/
      };
      //timezone 结构定义为:
      struct timezone{
        int tz_minuteswest; /*和Greenwich 时间差了多少分钟*/
        int tz_dsttime; /*日光节约时间的状态*/
      };
      //上述两个结构都定义在/usr/include/sys/time.h。tz_dsttime 所代表的状态如下
      DST_NONE /*不使用*/
      DST_USA /*美国*/
      DST_AUST /*澳洲*/
      DST_WET /*西欧*/
      DST_MET /*中欧*/
      DST_EET /*东欧*/
      DST_CAN /*加拿大*/
      DST_GB /*大不列颠*/
      DST_RUM /*罗马尼亚*/
      DST_TUR /*土耳其*/
      DST_AUSTALT /*澳洲(1986年以后)*/
      </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，失败返回－1，错误代码存于errno。附加说明EFAULT指针tv和tz所指的内存空间超出存取权限。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          #include "sys/time.h"
          #include "unistd.h"
          #include "stdio.h"

          int main(int argc, char const *argv[])
          {
              struct timeval tv;
              struct timezone tz;
              gettimeofday (&tv , &tz);
              printf("tv_sec; %ld\n", tv.tv_sec) ;
              printf("tv_usec; %ld\n", tv.tv_usec);
              printf("tz_minuteswest; %d\n", tz.tz_minuteswest);
              printf("tz_dsttime, %d\n", tz.tz_dsttime);

              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          tv_sec; 1431355061
          tv_usec; 896373
          tz_minuteswest; -480
          tz_dsttime, 0
        </pre>
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          
          <font class="font"><a name=gmtime></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> gmtime(取得目前时间和日期) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#ctime">ctime</a>,
        <a href="04.html#asctime">asctime</a>,
        <a href="04.html#localtime">localtime</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "time.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> struct tm*gmtime(const time_t*timep);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> gmtime()将参数timep 所指的time_t 结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果由结构tm返回。
      结构tm的定义为:
      <pre class="brush: cpp;">
        struct tm
        {
            int tm_sec;
            int tm_min;
            int tm_hour;
            int tm_mday;
            int tm_mon;
            int tm_year;
            int tm_wday;
            int tm_yday;
            int tm_isdst;
        };
        int tm_sec 代表目前秒数，正常范围为0 - 59，但允许至61秒
        int tm_min 代表目前分数，范围0 - 59
        int tm_hour 从午夜算起的时数，范围为0 - 23
        int tm_mday 目前月份的日数，范围01 - 31
        int tm_mon 代表目前月份，从一月算起，范围从0 - 11
        int tm_year 从1900 年算起至今的年数
        int tm_wday 一星期的日数，从星期一算起，范围为0 - 6
        int tm_yday 从今年1月1日算起至今的天数，范围为0 - 365
        int tm_isdst 日光节约时间的旗标
        //此函数返回的时间日期未经时区转换，而是UTC时间。
      </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回结构tm代表目前UTC 时间
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          #include  "time.h"
          #include "stdio.h"

          int main(int argc, char const *argv[])
          {
              const char *wday[] = {"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"};
              time_t timep;
              struct tm *p;
              time(&timep);
              p = gmtime(&timep);
              printf("%d %d %d", (1900+p->tm_year), (1+p->tm_mon), p->tm_mday);
              printf(" %s %d; %d; %d\n", wday[p->tm_wday], p->tm_hour, p->tm_min, p->tm_sec);
              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          2015 5 11 Mon 14; 43; 32
        </pre>
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=localtime></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> localtime(取得当地目前时间和日期) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#ctime">ctime</a>,
        <a href="04.html#asctime">asctime</a>,
        <a href="04.html#gmtime">gmtime</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "time.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> struct tm *localtime(const time_t 
      * timep);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> localtime()将参数timep所指的time_t结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果由结构tm返回。结构tm的定义请参考gmtime()。此函数返回的时间日期已经转换成当地时区。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回结构tm代表目前的当地时间。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          #include "time.h"
          #include "stdio.h"

          int main(int argc, char const *argv[])
          {
              const char *wday[] = {"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"};
              time_t timep;
              struct tm *p;
              time(&timep);
              p = localtime(&timep); /*取得当地时间*/
              printf ("%d %d %d ", (1900+p->tm_year), (1+p->tm_mon), p->tm_mday);
              printf(" %s %d: %d: %d\n", wday[p->tm_wday], p->tm_hour, p->tm_min, p->tm_sec);

              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font">
        <pre class="brush: cpp;">
          2015 5 11  Mon 22: 46: 48
        </pre>
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=mktime></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> mktime(将时间结构数据转换成经过的秒数) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#localtime">localtime</a>,
        <a href="04.html#asctime">asctime</a>,
        <a href="04.html#gmtime">gmtime</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "time.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> time_t mktime(strcut tm * timeptr);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> mktime()用来将参数timeptr所指的tm结构数据转换成从公元1970年1月1日0时0分0 
      秒算起至今的UTC时间所经过的秒数。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 返回经过的秒数。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> /* 用time()取得时间(秒数)，利用localtime()
      转换成struct tm 再利用mktine()将struct tm转换成原来的秒数*/
        <pre class="brush: cpp;">
          #include "time.h"
          #include "stdio.h"

          int main(int argc, char const *argv[])
          {
              time_t timep;
              struct tm *p;
              time(&timep);
              printf("time() : %ld \n", timep);
              p = localtime(&timep);
              timep = mktime(p);
              printf("time()->localtime()->mktime():%ld\n", timep);

              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          time() : 1431355844 
          time()->localtime()->mktime():1431355844
        </pre>
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=settimeofday></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> settimeofday(设置目前时间) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#time">time</a>,
        <a href="04.html#ctime">ctime</a>,
        <a href="04.html#ftime">ftime</a>,
        <a href="04.html#gettimeofday">gettimeofday</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        #include "sys/time.h"
		#include "unistd.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> int settimeofday ( const struct timeval *tv,const struct timezone *tz);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> settimeofday()会把目前时间设成由tv所指的结构信息，当地时区信息则设成tz所指的结构。详细的说明请参考gettimeofday()。注意，只有root权限才能使用此函数修改时间。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回0，失败返回－1，错误代码存于errno。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 错误代码 </font> </div>
      </td>
      <td valign="top"> <font class="font"> EPERM 并非由root权限调用settimeofday()，权限不够。EINVAL 时区或某个数据是不正确的，无法正确设置时间。
      </font> </td>
    </tr>
    <tr><td><br/><br/></td></tr>
    
    <tr>
      <td class="td">
        <div class="div">
          <font class="font"><a name=time></a></font> </div>
      </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 
        </font> </div>
      </td>
      <td valign="top"> <font class="font tt"> time(取得目前的时间) </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 相关函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <a href="04.html#ctime">ctime</a>,
        <a href="04.html#ftime">ftime</a>,
        <a href="04.html#gettimeofday">gettimeofday</a>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 表头文件 </font> </div>
      </td>
      <td valign="top"> <font class="font"> #include "time.h"
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 定义函数 </font> </div>
      </td>
      <td valign="top"> <font class="font"> time_t time(time_t *t);
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 函数说明 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 此函数会返回从公元1970年1月1日的UTC时间从0时0分0秒算起到现在所经过的秒数。如果t并非空指针的话，此函数也会将返回值存到t指针所指的内存。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 返回值 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 成功则返回秒数，失败则返回((time_t)-1)值，错误原因存于errno中。
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 范例 </font> </div>
      </td>
      <td valign="top"> <font class="font"> 
        <pre class="brush: cpp;">
          #include "time.h"
          #include "stdio.h"

          int main(int argc, char const *argv[])
          {
              int seconds = time((time_t*)NULL);
              printf("%d\n", seconds);
              return 0;
          }
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div"><font class="font"> 执行结果 </font> </div>
      </td>
      <td valign="top"> <font class="font">
        <pre class="brush: cpp;">
          1431356101
        </pre>
      </font> </td>
    </tr>
    <tr>
      <td class="td">
        <div class="div">
        </div>
      </td>
    </tr>
  </table>
</body>

</html>